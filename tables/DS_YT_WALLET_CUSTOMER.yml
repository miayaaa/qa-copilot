{
  "table_name": "MODELLED.DS_YT_WALLET_CUSTOMER",
  "project": "wallet",
  "table_grain": "Wallet_Member_Key",
  "description": "Unified intelligence table for wallet members. Tracks customer profiles, financial balances, device sightings, and billing account metrics using SCD2 logic.",
  "data_architecture": {
    "grain_definition": "Wallet_Member_Key is the unique identifier for a wallet member. A new key is generated if a Wallet_Id is transferred between owners.",
    "scd_logic": "SCD2 tracks changes over time. Use CURRENT_RECORD_IND = 1 to fetch the most recent state of a member.",
    "primary_key": "Wallet_Customer_Key",
    "natural_key": "Wallet_Id"
  },
  "columns": {
    "Core_Identifiers_and_SCD2": {
      "Wallet_Member_Key": {"type": "VARCHAR", "uniqueness": "UNIQUE_GRAIN", "desc": "Unique identifier for a wallet member. New key on ownership transfer."},
      "Wallet_Customer_Key": {"type": "VARCHAR", "pk": true, "desc": "Reference identifier for a specific version of a member's data."},
      "CURRENT_RECORD_IND": {"type": "NUMBER", "desc": "SCD2 Indicator: 1 = Latest/Current, 0 = Historical."},
      "Version_No": {"type": "NUMBER", "desc": "Sequential version per member. Increments on data change."},
      "Record_Start_Date_Time": {"type": "DATETIME", "desc": "Effective start time for this record version."},
      "Wallet_Id": {"type": "VARCHAR", "pii": "YES", "desc": "Wallet identifier (MSISDN or Username)."},
      "service_id_sha2": {"type": "VARCHAR", "desc": "Hashed version of the service ID."},
      "LCF_Load_Timestamp": {"type": "DATETIME", "desc": "System load time."},
      "LCF_Mock_Date_Ind": {"type": "NUMBER", "desc": "1=Test data, 0=Production."}
    },
    "Account_and_Demographics": {
      "Billing_Account_Number": {"type": "VARCHAR", "pii": "YES"},
      "Primary_Contact_Number": {"type": "VARCHAR", "pii": "YES"},
      "Customer_Segment": {"type": "VARCHAR", "desc": "e.g., Consumer."},
      "Wallet_Type": {"type": "VARCHAR", "desc": "On Account, Prepay or Non-customer."},
      "Service_Status_Name": {"type": "VARCHAR", "enum": ["Active", "Deleted", "Suspended", "Preactive", "Ported Out", "Inactive", "Unknown"]},
      "Join_Date": {"type": "DATE"},
      "Service_First_Activation_date": {"type": "DATE"},
      "account_risk_code": {"type": "VARCHAR", "desc": "Account risk level."},
      "account_compromised_flag": {"type": "VARCHAR", "enum": ["Y", "N"]},
      "consumer_volunteer_flag": {"type": "VARCHAR", "enum": ["Y", "N"]},
      "mobile_me_flag": {"type": "VARCHAR", "desc": "Internal employee indicator."}
    },
    "Financial_Balances_and_Value": {
      "current_earned_balance_excl_TI": {"type": "DECIMAL", "precision": 2, "desc": "Current balance, excluding Trade-In."},
      "GIVEAWAY_AMOUNT": {"type": "NUMERIC", "desc": "Initial calculated bonus value."},
      "ba_services_recurring_earn_amount": {"type": "NUMERIC", "precision": 2, "desc": "Ongoing BA earn value."},
      "plan_amount": {"type": "NUMERIC", "desc": "Monthly plan cost."},
      "BA_NEW_ACQUISITION_VALUE": {"type": "NUMERIC", "desc": "Value in cents for new acquisitions."},
      "PARTNER_EARN_VALUE": {"type": "NUMERIC", "desc": "Earned value from partners (e.g. Samsung)."},
      "latest_redemption_date": {"type": "DATE", "desc": "Last date customer used wallet credit."},
      "WALLET_REDEEMED_YESTERDAY_FLAG": {"type": "VARCHAR", "enum": ["Y", "N"]}
    },
    "Device_and_Network_GSMA": {
      "Handset_Brand_Name": {"type": "VARCHAR"},
      "Handset_Model_Name": {"type": "VARCHAR"},
      "Std_Handset_Model_Name": {"type": "VARCHAR", "source": "GSMA"},
      "NETWORK_TAC": {"type": "NUMERIC"},
      "NETWORK_OS_NAME": {"type": "VARCHAR"},
      "NETWORK_HARDWARE_CLASSIFICATION": {"type": "VARCHAR", "desc": "Entry, Low, Mid, High, Premium."},
      "NETWORK_YEAR_RELEASED": {"type": "NUMERIC"},
      "NETWORK_INTERNAL_STORAGE_CAPACITY": {"type": "VARCHAR"},
      "Handset_First_Used_Date": {"type": "DATE"},
      "Handset_Sales_Channel": {"type": "VARCHAR"},
      "Handset_Shipping_Order_Date": {"type": "DATE"}
    },
    "IFP_Details": {
      "Current_IFP_Device": {"type": "VARCHAR"},
      "Std_Current_IFP_Device": {"type": "VARCHAR", "source": "GSMA"},
      "Current_IFP_Start_Date": {"type": "DATE"},
      "Current_IFP_End_Date": {"type": "DATE"},
      "Current_IFP_Remaining_Months": {"type": "NUMBER"},
      "IFP_Term_Months": {"type": "NUMBER"},
      "ifp_term_month_number": {"type": "NUMBER"},
      "One_Upgrade_IFP_Add_On_Flag": {"type": "VARCHAR"}
    },
    "Billing_Account_Metrics": {
      "ba_count_active_services": {"type": "NUMERIC"},
      "ba_count_broadband": {"type": "INT"},
      "ba_count_mobile_on_account": {"type": "INT"},
      "ba_count_one_plan": {"type": "INT"},
      "ba_count_in_market_mobile_on_account": {"type": "INT"},
      "ba_count_mobile_medium": {"type": "INT", "note": "Obsolete: -1"},
      "ba_count_companion_mobile_medium": {"type": "INT", "note": "Obsolete: -1"},
      "ba_count_unlimited_fibre_max": {"type": "INT"},
      "ba_count_5g_wireless_broadband_12_month_term": {"type": "INT"},
      "ba_count_Fibre_Starter_Unlimited_Broadband": {"type": "INT"},
      "ba_count_Business_Fibre": {"type": "INT"},
      "BA_COUNT_MOBILE_LITE": {"type": "INT"},
      "BA_COUNT_MOBILE_SMALL_STARTER": {"type": "INT"},
      "ba_count_mobile_small": {"type": "INT"},
      "ba_count_mobile_medium_and_plus": {"type": "INT"},
      "ba_count_companion_mobile_mediu_and_plus": {"type": "INT"},
      "ba_count_companion_unlimited_mobile": {"type": "INT"},
      "BA_COUNT_COMPANION_EXTRA_LARGE_MOBILE": {"type": "INT"},
      "ba_count_unlimited_fibre_starter": {"type": "INT"},
      "ba_count_unlimited_fibre": {"type": "INT"},
      "ba_count_unlimited_ultrafast_hfc_max": {"type": "INT"},
      "ba_count_unlimited_vdsl_broadband": {"type": "INT"},
      "ba_count_unlimited_adsl_broadband": {"type": "INT"},
      "ba_count_gold_plan_12_month_term": {"type": "INT"},
      "ba_count_300gb_wireless_broadband_12_month_term": {"type": "INT"},
      "ba_count_300gb_wireless_broadband_with_calling_12_mth_term": {"type": "INT"},
      "ba_count_4g_uncapped_wireless_bb_12_month_term": {"type": "INT"},
      "ba_count_4g_uncapped_wbb_with_calling_12mth_term": {"type": "INT"},
      "ba_count_5g_wireless_broadband_with_calling_12_mth_term": {"type": "INT"},
      "ba_count_Fibre_Everyday_Unlimited_Broadband": {"type": "INT"},
      "ba_count_Fibre_Max_Unlimited_Broadband": {"type": "INT"},
      "ba_count_4G_Wireless_Lite": {"type": "INT"},
      "ba_count_Wireless_Unlimited": {"type": "INT"},
      "ba_count_Business_Fibre_with_Boost": {"type": "INT"},
      "ba_count_Business_Wireless": {"type": "INT"},
      "ba_count_bill_bonus": {"type": "NUMERIC"},
      "ba_count_eligible_service_cmgm": {"type": "NUMERIC"}
    },
    "Dosh_and_Offers": {
      "dosh_customer_flag": {"type": "VARCHAR", "enum": ["Y", "N"]},
      "dosh_new_customer_offer_earn_value": {"type": "NUMERIC"},
      "dosh_card_spend_earn_value": {"type": "NUMERIC"},
      "dosh_home_loan_initial_earn_value": {"type": "NUMERIC"},
      "dosh_salary_received_earn_value": {"type": "NUMERIC"},
      "dosh_migrated_customer_earn_value": {"type": "INT"},
      "dosh_homeloan_offer_flag": {"type": "VARCHAR"},
      "dosh_promotional_card_spend_earn_value": {"type": "INT"},
      "Wallet_Eligibility_Flag": {"type": "VARCHAR"},
      "Wallet_Eligibility_Releases": {"type": "VARCHAR"},
      "Consumer_In_Market_Plan_Indicator": {"type": "VARCHAR", "enum": ["Y", "N"]}
    },
    "Groups_and_Structure": {
      "Group_Member": {"type": "VARCHAR"},
      "Parent_Indicator": {"type": "VARCHAR"},
      "Child_Indicator": {"type": "VARCHAR"},
      "Number_of_Group_Members": {"type": "NUMBER"},
      "Number_of_Companions": {"type": "NUMBER"},
      "Parent_Wallet_Id": {"type": "VARCHAR"},
      "primary_wallet_flag": {"type": "VARCHAR"},
      "ba_has_primary_wallet_flag": {"type": "VARCHAR"}
    },
    "Billing_Delivery": {
      "bill_payment_method_desc": {"type": "VARCHAR"},
      "bill_delivery_type_desc": {"type": "VARCHAR"},
      "BILL_DAY_OF_MONTH_NUMBER": {"type": "NUMBER"},
      "Average_days_to_bill_close_count": {"type": "NUMBER"},
      "Billing_Account_Collections_Indicator": {"type": "VARCHAR"}
    },
    "Arrays_and_Discounts": {
      "Plan_Discount_ID_List": {"type": "ARRAY"},
      "Plan_Discount_SAM_ID_List": {"type": "ARRAY"},
      "Plan_Discount_Name_List": {"type": "ARRAY"},
      "Discount_Cash_In_Offer_Amount": {"type": "NUMBER"},
      "Cash_In_Offer_Status": {"type": "VARCHAR"},
      "EMPLOYEE_DISCOUNT_FLAG": {"type": "VARCHAR"},
      "EMPLOYEE_DISCOUNT_AMOUNT": {"type": "NUMERIC"}
    }
  }
}